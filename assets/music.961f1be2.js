var Q=Object.defineProperty;var R=(o,a,u)=>a in o?Q(o,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[a]=u;var m=(o,a,u)=>(R(o,typeof a!="symbol"?a+"":a,u),u);import Y from"./Icon.fd270e47.js";import Z from"./spotify.52c20da9.js";import{x as A,o as f,c as v,U,_ as L,r as p,h as G,P as H,a as s,F as E,A as T,z as n,W as j,b as g,I as y,D as J,X as K,t as b,p as ee,e as te,V as se}from"./entry.f778bb8d.js";import{u as ae}from"./fetch.2468d268.js";import{D as le}from"./DateFormat.26e47858.js";import"./config.50c77cb4.js";import"./nuxt-icon.c8292ece.js";class oe{constructor(a){m(this,"id");m(this,"previewUrl");m(this,"name");m(this,"durationMs");m(this,"spotifyLink");m(this,"artistsNames");m(this,"albumPicture");m(this,"albumName");this.id=a.id,this.previewUrl=a.previewUrl,this.name=a.name,this.durationMs=a.durationMs,this.spotifyLink=a.spotifyLink,this.artistsNames=a.artistsNames,this.albumPicture=a.albumPicture,this.albumName=a.albumName}get artistsNamesString(){return this.artistsNames.join(", ")}get trackDuration(){return le.durationToTime(this.durationMs,!0,"millisecond")}}const ne={class:"w-full h-full p-[15%] cursor-pointer rounded-full vinyl"},ie=["src"],re=A({__name:"AlbumImage",props:{albumPicture:{type:String,required:!0}},setup(o){return(a,u)=>(f(),v("div",ne,[o.albumPicture!=null&&o.albumPicture!=""?(f(),v("img",{key:0,src:o.albumPicture,draggable:"false",class:"rounded-full w-full h-full object-cover",alt:""},null,8,ie)):U("",!0)]))}});const I=L(re,[["__scopeId","data-v-13a3718d"]]),ue=o=>(ee("data-v-11aa41b5"),o=o(),te(),o),de={class:"grid grid-cols-1 sm:grid-cols-2 mt-5 h-[calc(100vh-240px)]"},ce={class:"flex flex-col mr-5 overflow-y-scroll overscroll-y-auto"},me={class:"flex mr-5 items-center justify-between mb-5"},pe={class:"flex h-full"},_e=["id"],ge=["id","draggable","onDragstart"],fe={class:y("group-hover/track:flex hidden")},ve={class:"flex-col flex ml-3 h-full justify-between"},he={class:"subtitle"},xe={class:"small-subtitle text-text-light dark:text-text-dark"},be={class:"flex flex-col items-end"},ye={class:"text-text-light dark:text-text-dark"},we=["href"],ke={class:"hidden sm:flex flex-col items-center justify-center h-full"},De=["onDragenter"],Ie=ue(()=>s("div",{class:"w-full h-full pointer-events-none top-0 left-0 absolute flex justify-center items-center"},[s("div",{class:"h-[20px] w-[20px] rounded-full bg-bg-article dark:bg-bg-article-dark shadow-inner"})],-1)),$e={class:"w-full h-full top-0 left-0 absolute justify-center items-center hidden group-hover:flex"},Ne={class:"px-10 w-full"},Pe={class:"overflow-hidden relative w-full h-[20px] mt-[20px]"},Ce=["id"],Se={class:"h-[70px] mt-[10px]"},Be=A({__name:"music",async setup(o){var N,P;let a,u;const z=se(),M=p((P=(N=([a,u]=J(()=>ae(`${z.public.api.route}/spotify`,"$BNPjnVefUz")),a=await a,u(),a).data.value)==null?void 0:N.map(e=>new oe(e)))==null?void 0:P.sort((e,t)=>e.albumName.localeCompare(t.albumName)||e.name.localeCompare(t.name))),i=p(),d=p(null),c=p(!1),_=p(null),h=p(!1),$=p(null);G(d,e=>{var t;(t=d.value)==null||t.addEventListener("ended",()=>c.value=!1)}),H(()=>{var e;(e=d.value)==null||e.pause()});function V(e,t){var r;_.value=t,(r=e.dataTransfer)==null||r.setDragImage(new Image,0,0)}function F(e){const t=document.getElementById(`copy-dragged-${_.value.id}`),r=document.getElementById("playing-image").clientWidth;t.style.display="block",t.style.boxShadow="4px 4px 14px 3px rgba(0,0,0,0.6)",t.style.top=`${e.pageY-(h.value?r:90)/2}px`,t.style.left=`${e.pageX-(h.value?r:90)/2}px`}function W(){const e=document.getElementById(`copy-dragged-${_.value.id}`);e.style.display="none"}function q(){h.value=!0;const e=document.getElementById(`copy-dragged-${_.value.id}`),t=document.getElementById("playing-image").clientWidth;e.style.width=`${t}px`,e.style.height=`${t}px`}function X(){h.value=!1;const e=document.getElementById(`copy-dragged-${_.value.id}`);e.style.width="90px",e.style.height="90px"}function O(){h.value=!1,D(_.value)}function D(e){var t,r,w,x;if(((t=i.value)==null?void 0:t.id)===e.id)c.value=!c.value;else{c.value=!1,(r=d.value)==null||r.pause(),i.value=e,d.value=new Audio(e.previewUrl),d.value.crossOrigin="anonymous",c.value=!0;const l=localStorage.theme==="dark"?"white":"black";K(d.value,$,{src:e.previewUrl,lineColor:l,lineWidth:1,corsAnonym:!0})}c.value?(w=d.value)==null||w.play():(x=d.value)==null||x.pause()}return(e,t)=>{var x;const r=Y,w=Z;return f(),v("div",de,[s("div",ce,[(f(!0),v(E,null,T(n(M),l=>{var C,S,B;return f(),v("div",me,[s("div",pe,[s("div",{id:`copy-dragged-${l.id}`,class:"dragged-item pointer-events-none hidden absolute left-0 top-0 w-[90px] h-[90px] rounded-full z-20"},[g(I,{"album-picture":l.albumPicture},null,8,["album-picture"])],8,_e),s("div",{id:`dragged-item-${l.id}`,draggable:((C=n(i))==null?void 0:C.id)!=l.id,onDragstart:k=>V(k,l),onDragend:W,onDrag:t[0]||(t[0]=k=>F(k)),class:y("w-[90px] h-[90px] relative group/track")},[g(I,{class:"!cursor-grab","album-picture":l.albumPicture},null,8,["album-picture"]),s("div",fe,[g(r,{onClick:k=>D(l),class:y("h-[30px] w-[30px] cursor-pointer top-[30px] left-[30px] absolute"),name:n(c)&&l.id==((S=n(i))==null?void 0:S.id)?"material-symbols:pause-rounded":"material-symbols:play-arrow-rounded"},null,8,["onClick","name"])])],40,ge),s("div",ve,[s("div",null,[s("h1",{class:y([l.id==((B=n(i))==null?void 0:B.id)?"text-primary dark:text-darkPrimary":"text-text-light dark:text-text-dark","small-title"])},b(l.name),3),s("p",he,b(l.artistsNamesString),1)]),s("p",xe,b(l.albumName),1)])]),s("div",be,[s("p",ye,b(l.trackDuration),1),s("a",{href:l==null?void 0:l.spotifyLink,target:"_blank"},[g(w,{filled:"",alt:"spotify icon",class:"mt-2"})],8,we)])])}),256))]),s("div",ke,[s("div",{onDrop:O,onDragover:t[2]||(t[2]=j(()=>{},["prevent"])),onDragenter:j(q,["prevent"]),onDragleave:X,class:"rounded-md square-vinyl p-10 bg-bg-article dark:bg-bg-article-dark shadow-[0_10px_40px_-15px_rgba(0,0,0,0.3)] dark:shadow-[0_10px_40px_-15px_rgba(0,0,0,1)] relative group"},[g(I,{id:"playing-image",class:y([n(c)?"spin":"spin paused","pointer-events-none"]),"album-picture":((x=n(i))==null?void 0:x.albumPicture)??""},null,8,["class","album-picture"]),Ie,s("div",$e,[g(r,{onClick:t[1]||(t[1]=l=>n(i)!=null?D(n(i)):null),class:"h-[70px] w-[70px] cursor-pointer",name:n(c)?"material-symbols:pause-rounded":"material-symbols:play-arrow-rounded"},null,8,["name"])])],40,De),s("div",Ne,[s("div",Pe,[n(i)!=null?(f(),v(E,{key:0},T([1,2],l=>s("p",{id:`track-info-${l}`,class:"text-text-light dark:text-text-dark small-subtitle absolute px-5 right-0 top-0 min-w-full w-fit overflow-visible whitespace-nowrap"},b(e.$t("music.currentTrackInfo",{title:n(i).name,artists:n(i).artistsNamesString,album:n(i).albumName})),9,Ce)),64)):U("",!0)])]),s("div",Se,[s("canvas",{ref_key:"canvas",ref:$},null,512)])])])}}});const Ve=L(Be,[["__scopeId","data-v-11aa41b5"]]);export{Ve as default};
