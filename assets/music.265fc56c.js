var X=Object.defineProperty;var O=(n,e,u)=>e in n?X(n,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):n[e]=u;var c=(n,e,u)=>(O(n,typeof e!="symbol"?e+"":e,u),u);import Q from"./Icon.5a53900f.js";import{x as T,o as _,c as v,U as j,_ as A,r as m,h as R,a,F as B,A as E,z as i,W as C,b as x,I as b,D as Y,X as Z,t as y,p as G,e as H,V as J}from"./entry.ce71b844.js";import{u as K}from"./fetch.7f615c39.js";import{D as ee}from"./DateFormat.26e47858.js";import"./config.8946f675.js";class te{constructor(e){c(this,"id");c(this,"previewUrl");c(this,"name");c(this,"durationMs");c(this,"spotifyLink");c(this,"artistsNames");c(this,"albumPicture");c(this,"albumName");this.id=e.id,this.previewUrl=e.previewUrl,this.name=e.name,this.durationMs=e.durationMs,this.spotifyLink=e.spotifyLink,this.artistsNames=e.artistsNames,this.albumPicture=e.albumPicture,this.albumName=e.albumName}get artistsNamesString(){return this.artistsNames.join(", ")}get trackDuration(){return ee.durationToTime(this.durationMs,!0,"millisecond")}}const se={class:"w-full h-full p-[15%] cursor-pointer rounded-full vinyl"},ae=["src"],le=T({__name:"AlbumImage",props:{albumPicture:{type:String,required:!0}},setup(n){return(e,u)=>(_(),v("div",se,[n.albumPicture!=null&&n.albumPicture!=""?(_(),v("img",{key:0,src:n.albumPicture,draggable:"false",class:"rounded-full w-full h-full object-cover",alt:""},null,8,ae)):j("",!0)]))}});const I=A(le,[["__scopeId","data-v-13a3718d"]]),ne=n=>(G("data-v-30650daa"),n=n(),H(),n),ie={class:"grid grid-cols-1 sm:grid-cols-2 mt-5 h-[calc(100vh-240px)]"},oe={class:"flex flex-col mr-5 overflow-y-scroll overscroll-y-auto"},re={class:"flex mr-5 items-center justify-between mb-5"},ue={class:"flex h-full"},de=["id"],ce=["id","draggable","onDragstart"],pe={class:b("group-hover/track:flex hidden")},me={class:"flex-col flex ml-3 h-full justify-between"},ge={class:"subtitle"},_e={class:"small-subtitle text-text-light dark:text-text-dark"},ve={class:"text-text-light dark:text-text-dark"},fe={class:"hidden sm:flex flex-col items-center justify-center h-full"},he=["onDragenter"],xe=ne(()=>a("div",{class:"w-full h-full pointer-events-none top-0 left-0 absolute flex justify-center items-center"},[a("div",{class:"h-[20px] w-[20px] rounded-full bg-bg-article dark:bg-bg-article-dark shadow-inner"})],-1)),ye={class:"w-full h-full top-0 left-0 absolute justify-center items-center hidden group-hover:flex"},be={class:"px-10 w-full"},we={class:"overflow-hidden relative w-full h-[20px] mt-[20px]"},ke=["id"],De={class:"h-[70px] mt-[10px]"},Ie=T({__name:"music",async setup(n){var N;let e,u;const U=J(),z=m((N=([e,u]=Y(()=>K(`${U.public.api.route}/spotify`,"$BNPjnVefUz")),e=await e,u(),e).data.value)==null?void 0:N.map(t=>new te(t))),o=m(),p=m(null),d=m(!1),g=m(null),f=m(!1),$=m(null);R(p,t=>{var s;(s=p.value)==null||s.addEventListener("ended",()=>d.value=!1)});function L(t,s){var r;g.value=s,(r=t.dataTransfer)==null||r.setDragImage(new Image,0,0)}function M(t){const s=document.getElementById(`copy-dragged-${g.value.id}`),r=document.getElementById("playing-image").clientWidth;s.style.display="block",s.style.boxShadow="4px 4px 14px 3px rgba(0,0,0,0.6)",s.style.top=`${t.pageY-(f.value?r:90)/2}px`,s.style.left=`${t.pageX-(f.value?r:90)/2}px`}function V(){const t=document.getElementById(`copy-dragged-${g.value.id}`);t.style.display="none"}function F(){f.value=!0;const t=document.getElementById(`copy-dragged-${g.value.id}`),s=document.getElementById("playing-image").clientWidth;t.style.width=`${s}px`,t.style.height=`${s}px`}function W(){f.value=!1;const t=document.getElementById(`copy-dragged-${g.value.id}`);t.style.width="90px",t.style.height="90px"}function q(){f.value=!1,D(g.value)}function D(t){var s,r,h,l;if(((s=o.value)==null?void 0:s.id)===t.id)d.value=!d.value;else{d.value=!1,(r=p.value)==null||r.pause(),o.value=t,p.value=new Audio(t.previewUrl),p.value.crossOrigin="anonymous",d.value=!0;const w=localStorage.theme==="dark"?"white":"black";Z(p.value,$,{src:t.previewUrl,lineColor:w,lineWidth:1,corsAnonym:!0})}d.value?(h=p.value)==null||h.play():(l=p.value)==null||l.pause()}return(t,s)=>{var h;const r=Q;return _(),v("div",ie,[a("div",oe,[(_(!0),v(B,null,E(i(z),l=>{var w,P,S;return _(),v("div",re,[a("div",ue,[a("div",{id:`copy-dragged-${l.id}`,class:"dragged-item pointer-events-none hidden absolute left-0 top-0 w-[90px] h-[90px] rounded-full z-20"},[x(I,{"album-picture":l.albumPicture},null,8,["album-picture"])],8,de),a("div",{id:`dragged-item-${l.id}`,draggable:((w=i(o))==null?void 0:w.id)!=l.id,onDragstart:k=>L(k,l),onDragend:V,onDrag:s[0]||(s[0]=k=>M(k)),class:b("w-[90px] h-[90px] relative group/track")},[x(I,{class:"!cursor-grab","album-picture":l.albumPicture},null,8,["album-picture"]),a("div",pe,[x(r,{onClick:k=>D(l),class:b("h-[30px] w-[30px] cursor-pointer top-[30px] left-[30px] absolute"),name:i(d)&&l.id==((P=i(o))==null?void 0:P.id)?"material-symbols:pause-rounded":"material-symbols:play-arrow-rounded"},null,8,["onClick","name"])])],40,ce),a("div",me,[a("div",null,[a("h1",{class:b([l.id==((S=i(o))==null?void 0:S.id)?"text-primary dark:text-darkPrimary":"text-text-light dark:text-text-dark","small-title"])},y(l.name),3),a("p",ge,y(l.artistsNamesString),1)]),a("p",_e,y(l.albumName),1)])]),a("p",ve,y(l.trackDuration),1)])}),256))]),a("div",fe,[a("div",{onDrop:q,onDragover:s[2]||(s[2]=C(()=>{},["prevent"])),onDragenter:C(F,["prevent"]),onDragleave:W,class:"rounded-md square-vinyl p-10 bg-bg-article dark:bg-bg-article-dark shadow-[0_10px_40px_-15px_rgba(0,0,0,0.3)] dark:shadow-[0_10px_40px_-15px_rgba(0,0,0,1)] relative group"},[x(I,{id:"playing-image",class:b([i(d)?"spin":"spin paused","pointer-events-none"]),"album-picture":((h=i(o))==null?void 0:h.albumPicture)??""},null,8,["class","album-picture"]),xe,a("div",ye,[x(r,{onClick:s[1]||(s[1]=l=>i(o)!=null?D(i(o)):null),class:"h-[70px] w-[70px] cursor-pointer",name:i(d)?"material-symbols:pause-rounded":"material-symbols:play-arrow-rounded"},null,8,["name"])])],40,he),a("div",be,[a("div",we,[i(o)!=null?(_(),v(B,{key:0},E([1,2],l=>a("p",{id:`track-info-${l}`,class:"text-text-light dark:text-text-dark small-subtitle absolute px-5 right-0 top-0 min-w-full w-fit overflow-visible whitespace-nowrap"},y(t.$t("music.currentTrackInfo",{title:i(o).name,artists:i(o).artistsNamesString,album:i(o).albumName})),9,ke)),64)):j("",!0)])]),a("div",De,[a("canvas",{ref_key:"canvas",ref:$},null,512)])])])}}});const Ce=A(Ie,[["__scopeId","data-v-30650daa"]]);export{Ce as default};
